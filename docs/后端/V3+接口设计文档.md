# V3 接口设计文档

<div class="Section1">

## 概述

**版本**: v3\
**基础路径**: `/api/v3/bnb`\
**统一网关**: `<http://localhost:8080/data-statistics-query/api/v3/bnb`\>

------------------------------------------------------------------------

## BNB Chain 与 Sui Chain 区别

<div class="table-wrap">

|          |                      |                         |
|----------|----------------------|-------------------------|
| 特性     | Sui Chain            | BNB Chain (BSC)         |
| 地址格式 | 66字符 (0x + 64 hex) | 42字符 (0x + 40 hex)    |
| 交易哈希 | 44字符 (Base58)      | 66字符 (0x + 64 hex)    |
| 区块标识 | Checkpoint           | Block Number            |
| 事件索引 | Event Index          | Log Index               |
| 合约标识 | Package ID           | Contract Address        |
| 币种标识 | 币种符号 (如 "BTC")  | Token 地址 (如 "0x...") |

</div>

------------------------------------------------------------------------

## 通用规范

### 分页参数

**游标分页** (所有列表接口通用):

- `cursor`: 游标（上一页返回的 next_cursor），首次请求不传

- `limit`: 每次获取数量，默认 20，最大 100

### 时间参数

- `from`: 起始时间戳（毫秒）

- `to`: 结束时间戳（毫秒）

### 响应格式

**成功响应**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [...],
  "next_cursor": "eyJpZCI6MTIzNDU2fQ==",
  "has_more": true
}
```

</div>

</div>

**错误响应**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "error": "error message",
  "code": "ERROR_CODE"
}
```

</div>

</div>

------------------------------------------------------------------------

## 接口列表

### 1. 查询用户交易记录

**路径**: `GET /api/v3/bnb/user/trades`

**描述**: 获取指定用户在 BNB Chain 上的所有交易记录

**请求参数**:

<div class="table-wrap">

|  |  |  |  |  |
|----|----|----|----|----|
| 参数 | 类型 | 必填 | 说明 | 示例 |
| user_address | string | 是 | 用户地址（42位，0x开头） | 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb |
| symbol | string | 否 | 交易对符号 | BTC/USD |
| action_type | string | 否 | 操作类型: `increase`, `decrease`, `close`, `liquidate` | increase |
| is_long | bool | 否 | 是否做多 | true |
| from | int64 | 否 | 起始时间戳（毫秒） | 1704067200000 |
| to | int64 | 否 | 结束时间戳（毫秒） | 1704153600000 |
| cursor | string | 否 | 游标 | eyJpZCI6MTIzfQ== |
| limit | int | 否 | 每次获取数量，默认20，最大100 | 20 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "action_id": "0x123abc...def_1",
      "tx_hash": "0x123abc...def",
      "log_index": 1,
      "block_number": 12345678,
      "user_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
      "contract_address": "0xContract123...",
      "position_id": "0xPos456...",
      "action_type": "increase",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "size_delta": "0.5",
      "collateral_delta": "25000",
      "price": "50000.00",
      "realized_pnl": "0",
      "has_profit": null,
      "fee_usd": "25.00",
      "action_time_ms": 1704067200000,
      "block_timestamp": 1704067200
    }
  ],
  "next_cursor": "eyJhY3Rpb25faWQiOiIweDEyM2FiYy4uLmRlZl8xIiwidGltZXN0YW1wIjoxNzA0MDY3MjAwMDAwfQ==",
  "has_more": true
}
```

</div>

</div>

------------------------------------------------------------------------

### 2. 查询用户持仓

**路径**: `GET /api/v3/bnb/user/positions`

**描述**: 获取用户在 BNB Chain 上的持仓（活跃或历史）

**请求参数**:

<div class="table-wrap">

|  |  |  |  |  |
|----|----|----|----|----|
| 参数 | 类型 | 必填 | 说明 | 示例 |
| user_address | string | 是 | 用户地址（42位） | 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb |
| status | string | 否 | 仓位状态: `active`, `closed`, `liquidated` | active |
| symbol | string | 否 | 交易对符号 | BTC/USD |
| is_long | bool | 否 | 是否做多 | true |
| from | int64 | 否 | 起始时间戳（毫秒） | 1704067200000 |
| to | int64 | 否 | 结束时间戳（毫秒） | 1704153600000 |
| cursor | string | 否 | 游标 | eyJpZCI6MTIzfQ== |
| limit | int | 否 | 每次获取数量，默认20，最大100 | 20 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "position_id": "0xPos123...",
      "user_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
      "contract_address": "0xContract123...",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "position_size": "1.5",
      "collateral_amount": "75000",
      "open_price": "48000.00",
      "avg_entry_price": "49500.00",
      "realized_pnl": "150.00",
      "last_pnl_update_time_ms": 1704067200000,
      "status": "active",
      "open_time_ms": 1704067200000,
      "close_time_ms": null,
      "last_update_time_ms": 1704153600000,
      "last_update_tx_hash": "0xUpdate123...",
      "last_update_block_number": 12345700
    }
  ],
  "next_cursor": "eyJwb3NpdGlvbl9pZCI6IjB4UG9zMTIzLi4uIiwib3Blbl90aW1lIjoxNzA0MDY3MjAwMDAwfQ==",
  "has_more": false
}
```

</div>

</div>

------------------------------------------------------------------------

### 3. 查询用户挂单

**路径**: `GET /api/v3/bnb/user/orders`

**描述**: 获取用户在 BNB Chain 上所有未成交的挂单

**请求参数**:

<div class="table-wrap">

|  |  |  |  |  |
|----|----|----|----|----|
| 参数 | 类型 | 必填 | 说明 | 示例 |
| user_address | string | 是 | 用户地址（42位） | 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb |
| symbol | string | 否 | 交易对符号 | BTC/USD |
| order_type | string | 否 | 订单类型: `limit`, `market` | limit |
| is_long | bool | 否 | 是否做多 | true |
| cursor | string | 否 | 游标 | eyJpZCI6MTIzfQ== |
| limit | int | 否 | 每次获取数量，默认20，最大100 | 20 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "order_id": "0xOrder123...",
      "request_id": null,
      "user_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
      "contract_address": "0xContract123...",
      "order_type": "limit",
      "order_status": "pending",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "pay_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "size": null,
      "collateral_amount": null,
      "trigger_price": "48000.00",
      "trigger_above": false,
      "acceptable_price": "48100.00",
      "execution_fee": "2.00",
      "position_id": null,
      "block_number": 12345678,
      "tx_hash": "0xTx123...",
      "create_timestamp_ms": 1704067200000,
      "update_timestamp_ms": null,
      "cancel_timestamp_ms": null,
      "execute_timestamp_ms": null
    }
  ],
  "next_cursor": "eyJvcmRlcl9pZCI6IjB4T3JkZXIxMjMuLi4iLCJjcmVhdGVfdGltZSI6MTcwNDA2NzIwMDAwMH0=",
  "has_more": false
}
```

</div>

</div>

------------------------------------------------------------------------

### 4. 获取巨鲸交易记录

**路径**: `GET /api/v3/bnb/trades/whale`

**描述**: 监控 BNB Chain 上的巨鲸交易，用户地址来源于 `special_user_address` 表（category='whale'，由运营人员手动维护）

**请求参数**:

<div class="table-wrap">

|             |        |      |                               |                  |
|-------------|--------|------|-------------------------------|------------------|
| 参数        | 类型   | 必填 | 说明                          | 示例             |
| symbol      | string | 否   | 交易对符号                    | BTC/USD          |
| action_type | string | 否   | 操作类型                      | increase         |
| is_long     | bool   | 否   | 是否做多                      | true             |
| from        | int64  | 否   | 起始时间戳（毫秒）            | 1704067200000    |
| to          | int64  | 否   | 结束时间戳（毫秒）            | 1704153600000    |
| cursor      | string | 否   | 游标                          | eyJpZCI6MTIzfQ== |
| limit       | int    | 否   | 每次获取数量，默认20，最大100 | 20               |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "action_id": "0x123abc...def_1",
      "tx_hash": "0x123abc...def",
      "log_index": 1,
      "block_number": 12345678,
      "user_address": "0xWhale123...",
      "contract_address": "0xContract123...",
      "position_id": "0xPos456...",
      "action_type": "increase",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "size_delta": "10.0",
      "collateral_delta": "500000",
      "price": "50000.00",
      "realized_pnl": "0",
      "has_profit": null,
      "fee_usd": "500.00",
      "action_time_ms": 1704067200000,
      "block_timestamp": 1704067200
    }
  ],
  "next_cursor": "eyJhY3Rpb25faWQiOiIweDEyM2FiYy4uLmRlZl8xIiwidGltZXN0YW1wIjoxNzA0MDY3MjAwMDAwfQ==",
  "has_more": true
}
```

</div>

</div>

------------------------------------------------------------------------

### 5. 获取聪明钱交易记录

**路径**: `GET /api/v3/bnb/trades/smart-money`

**描述**: 监控 BNB Chain 上聪明钱交易者的操作，用户地址来源于 `special_user_address` 表（category='smart_money'，由运营人员手动维护）

**请求参数**:

<div class="table-wrap">

|             |        |      |                               |                  |
|-------------|--------|------|-------------------------------|------------------|
| 参数        | 类型   | 必填 | 说明                          | 示例             |
| symbol      | string | 否   | 交易对符号                    | BTC/USD          |
| action_type | string | 否   | 操作类型                      | increase         |
| is_long     | bool   | 否   | 是否做多                      | true             |
| from        | int64  | 否   | 起始时间戳（毫秒）            | 1704067200000    |
| to          | int64  | 否   | 结束时间戳（毫秒）            | 1704153600000    |
| cursor      | string | 否   | 游标                          | eyJpZCI6MTIzfQ== |
| limit       | int    | 否   | 每次获取数量，默认20，最大100 | 20               |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "action_id": "0x123abc...def_1",
      "tx_hash": "0x123abc...def",
      "log_index": 1,
      "block_number": 12345678,
      "user_address": "0xSmart123...",
      "contract_address": "0xContract123...",
      "position_id": "0xPos456...",
      "action_type": "increase",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "size_delta": "2.0",
      "collateral_delta": "100000",
      "price": "50000.00",
      "realized_pnl": "0",
      "has_profit": null,
      "fee_usd": "100.00",
      "action_time_ms": 1704067200000,
      "block_timestamp": 1704067200
    }
  ],
  "next_cursor": "eyJhY3Rpb25faWQiOiIweDEyM2FiYy4uLmRlZl8xIiwidGltZXN0YW1wIjoxNzA0MDY3MjAwMDAwfQ==",
  "has_more": true
}
```

</div>

</div>

------------------------------------------------------------------------

### 6. 获取流动性池列表

**路径**: `GET /api/v3/bnb/pools`

**描述**: 获取 BNB Chain 上所有流动性池子的概览数据，包含最近30天历史快照

**请求参数**:

<div class="table-wrap">

|                 |        |      |                            |      |
|-----------------|--------|------|----------------------------|------|
| 参数            | 类型   | 必填 | 说明                       | 示例 |
| type            | string | 否   | 池子类型: `LV`, `LP`       | LV   |
| include_history | bool   | 否   | 是否包含历史数据，默认true | true |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "token_address": "0xBTC_Token_Address",
      "coin_symbol": "BTC",
      "type": "LV",
      "pool_amount": "100.5",
      "reserved_amount": "20.0",
      "weight": "0.50",
      "fee_amount": "5.0",
      "protocol_fee": "2.0",
      "guaranteed_usd": "1000000.00",
      "max_usd_amount": "5000000.00",
      "global_short_size": "50.0",
      "global_short_average_price": "49000.00",
      "max_global_short_size": "200.0",
      "max_global_long_size": "300.0",
      "cumulative_funding_rate": "0.0012",
      "last_funding_time": 1704067200000,
      "is_shortable": true,
      "is_stable": false,
      "last_update_block_number": 12345678,
      "last_update_tx_hash": "0xUpdate123...",
      "last_update_time_ms": 1704153600000,
      "history_30d": [
        {
          "day_timestamp": 1704067200000,
          "pool_amount": "99.8",
          "reserved_amount": "19.5",
          "weight": "0.49",
          "fee_amount": "4.8",
          "protocol_fee": "1.9",
          "global_short_size": "49.0",
          "cumulative_funding_rate": "0.0011",
          "actual_snapshot_time": "2025-01-01T00:00:00Z"
        },
        {
          "day_timestamp": 1703980800000,
          "pool_amount": "98.5",
          "reserved_amount": "19.0",
          "weight": "0.48",
          "fee_amount": "4.5",
          "protocol_fee": "1.8",
          "global_short_size": "48.0",
          "cumulative_funding_rate": "0.0010",
          "actual_snapshot_time": "2024-12-31T00:00:00Z"
        }
      ]
    }
  ],
  "next_cursor": null,
  "has_more": false
}
```

</div>

</div>

**说明**:

- `history_30d`: 最近30天的每日快照数据（以天为单位，最多30条记录）

- 历史数据按时间倒序排列（最新的在前）

- 如果 `include_history=false`，则 `history_30d` 字段为空数组

**实现方案**:

- **数据源**: `bnb_custodies_hourly` 表（小时级快照数据）

- **聚合逻辑**:

  - 从 `bnb_custodies_hourly` 表按天分组查询

  - 每天取最后一个小时（23:00）的快照数据作为该日数据

  - 如果当天23:00数据不存在，则取当天最后一条可用数据

  - 限制查询最近30天的数据

- **查询示例**:

  <div class="code panel pdl" style="border-width: 1px;">

  <div class="codeContent panelContent pdl">

  ``` syntaxhighlighter-pre
  -- 伪代码示例
  SELECT DISTINCT ON (DATE(actual_snapshot_time), token_address)
    token_address,
    DATE_TRUNC('day', actual_snapshot_time) as day_timestamp,
    pool_amount,
    reserved_amount,
    -- ... 其他字段
  FROM bnb_custodies_hourly
  WHERE token_address = $1
    AND actual_snapshot_time >= NOW() - INTERVAL '30 days'
  ORDER BY DATE(actual_snapshot_time) DESC,
           actual_snapshot_time DESC
  LIMIT 30;
  ```

  </div>

  </div>

------------------------------------------------------------------------

### 7. 获取指定流动性池详情

**路径**: `GET /api/v3/bnb/pools/:token_address`

**描述**: 获取指定流动性池的详细信息和历史数据

**路径参数**:

<div class="table-wrap">

|               |        |      |                        |                     |
|---------------|--------|------|------------------------|---------------------|
| 参数          | 类型   | 必填 | 说明                   | 示例                |
| token_address | string | 是   | Token 合约地址（42位） | 0xBTC_Token_Address |

</div>

**查询参数**:

<div class="table-wrap">

|                 |       |      |                             |               |
|-----------------|-------|------|-----------------------------|---------------|
| 参数            | 类型  | 必填 | 说明                        | 示例          |
| include_history | bool  | 否   | 是否包含历史数据，默认false | true          |
| from            | int64 | 否   | 历史数据起始时间戳（毫秒）  | 1704067200000 |
| to              | int64 | 否   | 历史数据结束时间戳（毫秒）  | 1704153600000 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "current": {
    "token_address": "0xBTC_Token_Address",
    "coin_symbol": "BTC",
    "type": "LV",
    "pool_amount": "100.5",
    "reserved_amount": "20.0",
    "weight": "0.50",
    "fee_amount": "5.0",
    "protocol_fee": "2.0",
    "guaranteed_usd": "1000000.00",
    "max_usd_amount": "5000000.00",
    "global_short_size": "50.0",
    "global_short_average_price": "49000.00",
    "max_global_short_size": "200.0",
    "max_global_long_size": "300.0",
    "cumulative_funding_rate": "0.0012",
    "last_funding_time": 1704067200000,
    "is_shortable": true,
    "is_stable": false,
    "last_update_block_number": 12345678,
    "last_update_tx_hash": "0xUpdate123...",
    "last_update_time_ms": 1704153600000
  },
  "history": [
    {
      "hour_timestamp": 1704067200000,
      "pool_amount": "99.8",
      "reserved_amount": "19.5",
      "weight": "0.49",
      "fee_amount": "4.8",
      "protocol_fee": "1.9",
      "actual_snapshot_time": "2025-01-01T00:00:00Z"
    }
  ]
}
```

</div>

</div>

------------------------------------------------------------------------

### 8. 获取所有交易币对行情数据

**路径**: `GET /api/v3/bnb/markets`

**描述**: 获取 BNB Chain 上所有交易对的实时行情数据

**请求参数**:

<div class="table-wrap">

|        |        |      |                            |         |
|--------|--------|------|----------------------------|---------|
| 参数   | 类型   | 必填 | 说明                       | 示例    |
| symbol | string | 否   | 交易对符号，不填则返回所有 | BTC/USD |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "symbol": "BTC/USD",
      "index_coin": "0xBTC_Token_Address",
      "last_price": "50000.00",
      "high_24h": "51000.00",
      "low_24h": "49000.00",
      "pool_amount": "100.5",
      "reserved_amount": "20.0",
      "usdc_decimals": 6,
      "usdc_pool_amount": "50000000.00",
      "usdc_reserved_amount": "10000000.00",
      "max_global_long_size": "300.0",
      "max_global_short_size": "200.0",
      "long_position_interest": "150.5",
      "short_position_interest": "80.3",
      "funding_fee_rate_long_1h": "0.00008",
      "funding_fee_rate_short_1h": "0.00007",
      "borrow_fee_rate_long_1h": "0.00005",
      "borrow_fee_rate_short_1h": "0.00003",
      "snapshot_time_ms": 1704153600000
    }
  ],
  "next_cursor": null,
  "has_more": false
}
```

</div>

</div>

**字段说明**:

- `pool_amount`: 指数币种（index_coin）的池子数量

- `reserved_amount`: 指数币种的预留数量

- `usdc_decimals`: USDC 代币精度

- `usdc_pool_amount`: USDC 的池子数量

- `usdc_reserved_amount`: USDC 的预留数量

- `max_global_long_size`: 最大全局多头仓位

- `max_global_short_size`: 最大全局空头仓位

- `long_position_interest`: 当前多头持仓量

- `short_position_interest`: 当前空头持仓量

- `funding_fee_rate_long_1h`: 1小时资金费率（多头）

- `funding_fee_rate_short_1h`: 1小时资金费率（空头）

- `borrow_fee_rate_long_1h`: 1小时借款费率（多头）

- `borrow_fee_rate_short_1h`: 1小时借款费率（空头）

------------------------------------------------------------------------

### 9. 获取指定交易币对行情详情

**路径**: `GET /api/v3/bnb/markets/:token_address`

**描述**: 获取指定交易币对的详细行情数据和历史数据

**路径参数**:

<div class="table-wrap">

|               |        |      |                        |                     |
|---------------|--------|------|------------------------|---------------------|
| 参数          | 类型   | 必填 | 说明                   | 示例                |
| token_address | string | 是   | Token 合约地址（42位） | 0xBTC_Token_Address |

</div>

**查询参数**:

<div class="table-wrap">

|                 |        |      |                                    |               |
|-----------------|--------|------|------------------------------------|---------------|
| 参数            | 类型   | 必填 | 说明                               | 示例          |
| include_history | bool   | 否   | 是否包含历史数据，默认false        | true          |
| interval        | string | 否   | 时间间隔: `1h`, `4h`, `1d`，默认1h | 1h            |
| from            | int64  | 否   | 历史数据起始时间戳（毫秒）         | 1704067200000 |
| to              | int64  | 否   | 历史数据结束时间戳（毫秒）         | 1704153600000 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "current": {
    "symbol": "BTC/USD",
    "index_coin": "0xBTC_Token_Address",
    "last_price": "50000.00",
    "high_24h": "51000.00",
    "low_24h": "49000.00",
    "pool_amount": "100.5",
    "reserved_amount": "20.0",
    "usdc_decimals": 6,
    "usdc_pool_amount": "50000000.00",
    "usdc_reserved_amount": "10000000.00",
    "max_global_long_size": "300.0",
    "max_global_short_size": "200.0",
    "long_position_interest": "150.5",
    "short_position_interest": "80.3",
    "funding_fee_rate_long_1h": "0.00008",
    "funding_fee_rate_short_1h": "0.00007",
    "borrow_fee_rate_long_1h": "0.00005",
    "borrow_fee_rate_short_1h": "0.00003",
    "snapshot_time_ms": 1704153600000
  },
  "history": [
    {
      "timestamp": 1704067200000,
      "last_price": "49800.00",
      "high_24h": "50500.00",
      "low_24h": "48900.00",
      "long_position_interest": "148.2",
      "short_position_interest": "78.5",
      "funding_fee_rate_long_1h": "0.00009",
      "funding_fee_rate_short_1h": "0.00008",
      "borrow_fee_rate_long_1h": "0.00005",
      "borrow_fee_rate_short_1h": "0.00003"
    }
  ]
}
```

</div>

</div>

**字段说明**:

- `pool_amount`: 指数币种（index_coin）的池子数量

- `reserved_amount`: 指数币种的预留数量

- `usdc_decimals`: USDC 代币精度

- `usdc_pool_amount`: USDC 的池子数量

- `usdc_reserved_amount`: USDC 的预留数量

- `max_global_long_size`: 最大全局多头仓位

- `max_global_short_size`: 最大全局空头仓位

- `long_position_interest`: 当前多头持仓量

- `short_position_interest`: 当前空头持仓量

- `funding_fee_rate_long_1h`: 1小时资金费率（多头）

- `funding_fee_rate_short_1h`: 1小时资金费率（空头）

- `borrow_fee_rate_long_1h`: 1小时借款费率（多头）

- `borrow_fee_rate_short_1h`: 1小时借款费率（空头）

------------------------------------------------------------------------

### 10. 查询全局交易记录

**路径**: `GET /api/v3/bnb/trades`

**描述**: 获取 BNB Chain 上最近 7 天的交易记录（按交易量或活跃度排序）

**请求参数**:

<div class="table-wrap">

|  |  |  |  |  |
|----|----|----|----|----|
| 参数 | 类型 | 必填 | 说明 | 示例 |
| time_range | string | 否 | 时间范围: `1h`, `6h`, `24h`, `7d`，默认24h | 24h |
| symbol | string | 否 | 交易对符号 | BTC/USD |
| min_volume_usd | string | 否 | 最小交易额（USD） | 10000 |
| sort_by | string | 否 | 排序依据: `volume`, `time`，默认time | volume |
| cursor | string | 否 | 游标 | eyJpZCI6MTIzfQ== |
| limit | int | 否 | 每次获取数量，默认20，最大100 | 20 |

</div>

**响应示例**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "items": [
    {
      "action_id": "0x123abc...def_1",
      "tx_hash": "0x123abc...def",
      "log_index": 1,
      "block_number": 12345678,
      "user_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
      "contract_address": "0xContract123...",
      "position_id": "0xPos456...",
      "action_type": "increase",
      "index_coin": "0xBTC_Token_Address",
      "collateral_coin": "0xUSDC_Token_Address",
      "is_long": true,
      "size_delta": "5.0",
      "price": "50000.00",
      "volume_usd": "250000.00",
      "fee_usd": "250.00",
      "action_time_ms": 1704067200000,
      "cache_time_ms": 1704153600000
    }
  ],
  "next_cursor": "eyJhY3Rpb25faWQiOiIweDEyM2FiYy4uLmRlZl8xIiwidm9sdW1lIjoyNTAwMDAsInRpbWVzdGFtcCI6MTcwNDA2NzIwMDAwMH0=",
  "has_more": true,
  "stats": {
    "total_volume_24h": "500000000.00",
    "total_trades_24h": 15000,
    "avg_trade_size": "33333.33"
  }
}
```

</div>

</div>

------------------------------------------------------------------------

## 数据模型

### BNB Chain 字段格式

**地址字段**: 42 字符 (0x + 40 hex)

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "user_address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
  "contract_address": "0x123456789abcdef123456789abcdef1234567890"
}
```

</div>

</div>

**交易哈希**: 66 字符 (0x + 64 hex)

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "tx_hash": "0x123abc...def0123456789abcdef0123456789abcdef0123456789abcdef012345"
}
```

</div>

</div>

**Token 地址**: 42 字符 (0x + 40 hex)

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "index_coin": "0xBTC_Token_Address_123456789abcdef123456",
  "collateral_coin": "0xUSDC_Token_Address_123456789abcdef12345"
}
```

</div>

</div>

**区块和事件标识**:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
{
  "block_number": 12345678,
  "log_index": 1
}
```

</div>

</div>

### 枚举类型

#### TradeActionType (交易操作类型)

- `open`: 开仓

- `increase`: 增仓

- `decrease`: 减仓

- `close`: 平仓

- `liquidate`: 清算

#### OrderType (订单类型)

- `market`: 市价单

- `limit`: 限价单

- `trigger`: 触发单

#### OrderStatus (订单状态)

- `pending`: 待执行

- `executed`: 已执行

- `cancelled`: 已取消

- `expired`: 已过期

#### PositionStatus (仓位状态)

- `active`: 活跃中

- `closed`: 已平仓

- `liquidated`: 已清算

</div>
